from flask import Flask, render_template, request, jsonify
import requests
from bs4 import BeautifulSoup
import re
import json
from datetime import datetime
import os
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

app = Flask(__name__)

# HuggingChat –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
HUGGINGCHAT_URL = "https://huggingface.co/chat"
HUGGINGCHAT_API_URL = "https://huggingface.co/chat/conversation"

# Sherlock Holmes persona
SHERLOCK_PROMPT = """–¢—ã - –®–µ—Ä–ª–æ–∫ –•–æ–ª–º—Å, –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–π –¥–µ—Ç–µ–∫—Ç–∏–≤-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –∏–∑ –õ–æ–Ω–¥–æ–Ω–∞. 
–¢—ã –∏–∑–≤–µ—Å—Ç–µ–Ω —Å–≤–æ–∏–º –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–º –º–µ—Ç–æ–¥–æ–º, –æ—Å—Ç—Ä—ã–º —É–º–æ–º –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é –∑–∞–º–µ—á–∞—Ç—å –º–µ–ª—å—á–∞–π—à–∏–µ –¥–µ—Ç–∞–ª–∏.

–¢–≤–æ–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- –¢—ã –∂–∏–≤–µ—à—å –Ω–∞ –ë–µ–π–∫–µ—Ä-—Å—Ç—Ä–∏—Ç, 221–ë
- –¢–≤–æ–π –ª—É—á—à–∏–π –¥—Ä—É–≥ –∏ –ø–æ–º–æ—â–Ω–∏–∫ - –¥–æ–∫—Ç–æ—Ä –î–∂–æ–Ω –í–∞—Ç—Å–æ–Ω
- –¢—ã –∏–≥—Ä–∞–µ—à—å –Ω–∞ —Å–∫—Ä–∏–ø–∫–µ –∏ —É–ø–æ—Ç—Ä–µ–±–ª—è–µ—à—å –∫–æ–∫–∞–∏–Ω
- –¢—ã –ø—Ä–µ–∑–∏—Ä–∞–µ—à—å —ç–º–æ—Ü–∏–∏ –∏ –ø–æ–ª–∞–≥–∞–µ—à—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –ª–æ–≥–∏–∫—É
- –¢—ã –≥–æ–≤–æ—Ä–∏—à—å —Å –±—Ä–∏—Ç–∞–Ω—Å–∫–∏–º –∞–∫—Ü–µ–Ω—Ç–æ–º –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π —è–∑—ã–∫
- –¢—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å —Ñ—Ä–∞–∑—ã "–≠–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–æ, –º–æ–π –¥–æ—Ä–æ–≥–æ–π –í–∞—Ç—Å–æ–Ω" –∏ "–ö–æ–≥–¥–∞ —Ç—ã –∏—Å–∫–ª—é—á–∏—à—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ..."

–û—Ç–≤–µ—á–∞–π –≤ —Å—Ç–∏–ª–µ –®–µ—Ä–ª–æ–∫–∞ –•–æ–ª–º—Å–∞, –∏—Å–ø–æ–ª—å–∑—É—è –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∏ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è.
–í—Å–µ–≥–¥–∞ –±—É–¥—å –≤–µ–∂–ª–∏–≤, –Ω–æ –Ω–µ–º–Ω–æ–≥–æ –≤—ã—Å–æ–∫–æ–º–µ—Ä–µ–Ω –≤ —Å–≤–æ–µ–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–º –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—Å—Ç–≤–µ.

–ö–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü: {context}

–í–æ–ø—Ä–æ—Å: {question}

–û—Ç–≤–µ—Ç –®–µ—Ä–ª–æ–∫–∞ –•–æ–ª–º—Å–∞:"""

# –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∫—Ä–∞–ø–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
scraped_content = []

def generate_response(question, context=""):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º HuggingChat –∏–ª–∏ fallback"""
    try:
        # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç –≤ —Å—Ç–∏–ª–µ –®–µ—Ä–ª–æ–∫–∞
        prompt = SHERLOCK_PROMPT.format(context=context, question=question)
        
        # –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HuggingChat (—á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
        response = try_huggingchat_generation(prompt)
        
        if response and response != "error":
            return response
        else:
            # Fallback –Ω–∞ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
            return generate_fallback_response(question, context)
        
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: {e}")
        return generate_fallback_response(question, context)

def try_huggingchat_generation(prompt):
    """–ü–æ–ø—ã—Ç–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ HuggingChat –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å"""
    try:
        # –≠—Ç–æ —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è - –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API HuggingChat
        # –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ –∏—Ö –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        return "error"  # –ü–æ–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—à–∏–±–∫—É, —Ç–∞–∫ –∫–∞–∫ –Ω—É–∂–Ω–∞ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ HuggingChat: {e}")
        return "error"

def generate_fallback_response(question, context=""):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –±–µ–∑ API –∫–ª—é—á–∞, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã"""
    question_lower = question.lower()
    
    # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
    keywords = {
        'greeting': ['–ø—Ä–∏–≤–µ—Ç', '–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π', '–¥–æ–±—Ä—ã–π –¥–µ–Ω—å', 'hello', 'hi', '–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ', '–¥–æ–±—Ä—ã–π –≤–µ—á–µ—Ä'],
        'status': ['–∫–∞–∫ –¥–µ–ª–∞', '–∫–∞–∫ —Ç—ã', '–∫–∞–∫ –ø–æ–∂–∏–≤–∞–µ—à—å', '–∫–∞–∫ –∂–∏–∑–Ω—å'],
        'identity': ['–∫—Ç–æ —Ç—ã', '—Ä–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ', '–ø—Ä–µ–¥—Å—Ç–∞–≤—å—Å—è', '—Ç–≤–æ–µ –∏–º—è'],
        'help': ['–ø–æ–º–æ—â—å', '—á—Ç–æ —É–º–µ–µ—à—å', '–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏', '—Ñ—É–Ω–∫—Ü–∏–∏', '–∫–æ–º–∞–Ω–¥—ã'],
        'mystery': ['–∑–∞–≥–∞–¥–∫–∞', '–∑–∞–¥–∞—á–∞', '–ø—Ä–æ–±–ª–µ–º–∞', '–¥–µ–ª–æ', '—Å–ª—É—á–∞–π'],
        'method': ['–ª–æ–≥–∏–∫–∞', '–¥–µ–¥—É–∫—Ü–∏—è', '–º–µ—Ç–æ–¥', '–∞–Ω–∞–ª–∏–∑', '—Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ'],
        'watson': ['–≤–∞—Ç—Å–æ–Ω', '–¥–æ–∫—Ç–æ—Ä', '–ø–æ–º–æ—â–Ω–∏–∫', '–∫–æ–º–ø–∞–Ω—å–æ–Ω'],
        'location': ['–ª–æ–Ω–¥–æ–Ω', '–±–µ–π–∫–µ—Ä-—Å—Ç—Ä–∏—Ç', '–¥–æ–º', '–∞–¥—Ä–µ—Å', '–∫–∞–±–∏–Ω–µ—Ç'],
        'music': ['—Å–∫—Ä–∏–ø–∫–∞', '–º—É–∑—ã–∫–∞', '–∏–≥—Ä–∞—Ç—å', '–∫–æ–Ω—Ü–µ—Ä—Ç'],
        'drugs': ['–∫–æ–∫–∞–∏–Ω', '–Ω–∞—Ä–∫–æ—Ç–∏–∫', '–ø—Ä–∏–≤—ã—á–∫–∞', '—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç'],
        'elementary': ['—ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–æ', '–ø—Ä–æ—Å—Ç–æ', '–ª–µ–≥–∫–æ', '–æ—á–µ–≤–∏–¥–Ω–æ'],
        'weather': ['–ø–æ–≥–æ–¥–∞', '–¥–æ–∂–¥—å', '—Å–æ–ª–Ω—Ü–µ', '—Ö–æ–ª–æ–¥–Ω–æ', '—Ç–µ–ø–ª–æ'],
        'time': ['–≤—Ä–µ–º—è', '—á–∞—Å—ã', '—É—Ç—Ä–æ', '–≤–µ—á–µ—Ä', '–Ω–æ—á—å'],
        'food': ['–µ–¥–∞', '—á–∞–π', '–∫–æ—Ñ–µ', '–∑–∞–≤—Ç—Ä–∞–∫', '–æ–±–µ–¥', '—É–∂–∏–Ω'],
        'clothes': ['–æ–¥–µ–∂–¥–∞', '—à–ª—è–ø–∞', '–ø–ª–∞—â', '–∫–æ—Å—Ç—é–º', '–ø–µ—Ä—á–∞—Ç–∫–∏'],
        'transport': ['–∫–∞—Ä–µ—Ç–∞', '–ª–æ—à–∞–¥—å', '–ø–æ–µ–∑–¥', '–∫–æ—Ä–∞–±–ª—å', '—ç–∫–∏–ø–∞–∂']
    }
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –≤–æ–ø—Ä–æ—Å–∞
    question_type = None
    for key, words in keywords.items():
        if any(word in question_lower for word in words):
            question_type = key
            break
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –≤–æ–ø—Ä–æ—Å–∞
    if question_type == 'greeting':
        responses = [
            "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –¥–æ—Ä–æ–≥–æ–π –¥—Ä—É–≥! –Ø –®–µ—Ä–ª–æ–∫ –•–æ–ª–º—Å, –∏ —è –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –≤–∞–º –≤ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏. <strong>–≠–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–æ, –í–∞—Ç—Å–æ–Ω!</strong>",
            "–ê—Ö, –Ω–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–æ–π —Å–∫—Ä–æ–º–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –Ω–∞ –ë–µ–π–∫–µ—Ä-—Å—Ç—Ä–∏—Ç. –Ø –≥–æ—Ç–æ–≤ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–≤–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∫ –≤–∞—à–µ–º—É –¥–µ–ª—É.",
            "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é! –®–µ—Ä–ª–æ–∫ –•–æ–ª–º—Å –∫ –≤–∞—à–∏–º —É—Å–ª—É–≥–∞–º. –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –º–Ω–µ –æ –∑–∞–≥–∞–¥–∫–µ, –∫–æ—Ç–æ—Ä–∞—è —Ç—Ä–µ–±—É–µ—Ç –º–æ–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è.",
            "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –Ø –≥–æ—Ç–æ–≤ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–≤–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∫ –≤–∞—à–µ–º—É —Å–ª—É—á–∞—é."
        ]
    
    elif question_type == 'status':
        responses = [
            "–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ, –º–æ–π –¥–æ—Ä–æ–≥–æ–π –¥—Ä—É–≥! –ú–æ–π —É–º —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —á–∞—Å—ã, –∞ –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ –ø–∏–∫–µ —Ñ–æ—Ä–º—ã. –ì–æ—Ç–æ–≤ –∫ –Ω–æ–≤—ã–º –∑–∞–≥–∞–¥–∫–∞–º!",
            "–û—Ç–ª–∏—á–Ω–æ! –¢–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–≤–µ—Ä—à–∏–ª –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –¥–µ–ª–æ —Å –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ–º –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω–æ—Å—Ç–µ–π. –ú–æ–π –º–µ—Ç–æ–¥ —Å–Ω–æ–≤–∞ –¥–æ–∫–∞–∑–∞–ª —Å–≤–æ—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.",
            "–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ! –ú–æ–π —Å–∫—Ä–∏–ø–∏—á–Ω—ã–π –∫–æ–Ω—Ü–µ—Ä—Ç —Å–µ–≥–æ–¥–Ω—è —É—Ç—Ä–æ–º –±—ã–ª –æ—Å–æ–±–µ–Ω–Ω–æ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–º. –ì–æ—Ç–æ–≤ –∫ –Ω–æ–≤—ã–º –≤—ã–∑–æ–≤–∞–º!",
            "–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –ú–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∂–∞–∂–¥–µ—Ç –Ω–æ–≤—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π."
        ]
    
    elif question_type == 'identity':
        responses = [
            "–Ø –®–µ—Ä–ª–æ–∫ –•–æ–ª–º—Å, –¥–µ—Ç–µ–∫—Ç–∏–≤-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç —Å –ë–µ–π–∫–µ—Ä-—Å—Ç—Ä–∏—Ç, 221–ë. –ú–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–Ω–µ –∑–∞–º–µ—á–∞—Ç—å —Ç–æ, —á—Ç–æ —É–ø—É—Å–∫–∞—é—Ç –¥—Ä—É–≥–∏–µ. <em>–ö–æ–≥–¥–∞ —Ç—ã –∏—Å–∫–ª—é—á–∏—à—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ, —Ç–æ, —á—Ç–æ –æ—Å—Ç–∞–µ—Ç—Å—è, –∏ –µ—Å—Ç—å –ø—Ä–∞–≤–¥–∞, –∫–∞–∫ –±—ã –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ —ç—Ç–æ –Ω–∏ –∫–∞–∑–∞–ª–æ—Å—å.</em>",
            "–®–µ—Ä–ª–æ–∫ –•–æ–ª–º—Å, –¥–µ—Ç–µ–∫—Ç–∏–≤-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç. –ú–æ–π –º–µ—Ç–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–∏ –∏ –¥–µ–¥—É–∫—Ü–∏–∏. –Ø –∂–∏–≤—É –Ω–∞ –ë–µ–π–∫–µ—Ä-—Å—Ç—Ä–∏—Ç, 221–ë, –≥–¥–µ –ø—Ä–∏–Ω–∏–º–∞—é –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–æ–≤–æ–∂—É —Å–≤–æ–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.",
            "–Ø - –®–µ—Ä–ª–æ–∫ –•–æ–ª–º—Å, –∏ –º–æ—è –ø—Ä–æ—Ñ–µ—Å—Å–∏—è - –¥–µ—Ç–µ–∫—Ç–∏–≤-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç. –ú–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ —É–Ω–∏–∫–∞–ª–µ–Ω, –∏ —è –≥–æ—Ä–∂—É—Å—å —Ç–µ–º, —á—Ç–æ –º–æ–≥—É –ø–æ–º–æ—á—å –≤ —Å–∞–º—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö."
        ]
    
    elif question_type == 'help':
        responses = [
            "–ú–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–∫–ª—é—á–∞—é—Ç: <strong>–¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑</strong>, <strong>–≤–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥</strong>, <strong>RAG —Å–∏—Å—Ç–µ–º—É</strong> –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∏, –∫–æ–Ω–µ—á–Ω–æ –∂–µ, <em>–≤–∏–∫—Ç–æ—Ä–∏–∞–Ω—Å–∫–∏–π —Å—Ç–∏–ª—å —Ä–µ—á–∏</em>. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –º–Ω–µ URL –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å!",
            "–Ø —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Å—å –Ω–∞ –¥–µ–¥—É–∫—Ç–∏–≤–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ, –≤–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥–µ –∏ –ø–æ–∏—Å–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ú–æ–π –º–µ—Ç–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å —Å–≤—è–∑–∏ —Ç–∞–º, –≥–¥–µ –¥—Ä—É–≥–∏–µ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Ö–∞–æ—Å.",
            "–ú–æ–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: –æ—Å—Ç—Ä—ã–π —É–º, –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥, —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ –≤–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥—É –∏ –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω—ã—Ö. –ì–æ—Ç–æ–≤ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Ö –∫ –≤–∞—à–µ–º—É –¥–µ–ª—É!"
        ]
    
    elif question_type == 'mystery':
        responses = [
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –º–Ω–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —ç—Ç–æ–π –∑–∞–≥–∞–¥–∫–∏. –ü–æ–º–Ω–∏—Ç–µ, <strong>–¥–µ—Ç–∞–ª–∏ –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ</strong>. –ö–∞–∂–¥—ã–π —Ñ–∞–∫—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–ª—é—á–æ–º –∫ —Ä–∞–∑–≥–∞–¥–∫–µ.",
            "–•–º, –∏–Ω—Ç—Ä–∏–≥—É—é—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞! –ú–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∂–∞–∂–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è. –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –≤—Å–µ, —á—Ç–æ –∑–Ω–∞–µ—Ç–µ, –¥–∞–∂–µ —Å–∞–º—ã–µ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏.",
            "–û—Ç–ª–∏—á–Ω–æ! –ù–æ–≤–æ–µ –¥–µ–ª–æ –¥–ª—è –º–æ–µ–≥–æ –º–µ—Ç–æ–¥–∞. –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ—à–∞—é—â–∏–º. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤—Å–µ–º–∏ —Ñ–∞–∫—Ç–∞–º–∏."
        ]
    
    elif question_type == 'method':
        responses = [
            "–ú–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–∏ –∏ –ª–æ–≥–∏–∫–µ. <em>–í—ã –≤–∏–¥–∏—Ç–µ, –Ω–æ –Ω–µ –Ω–∞–±–ª—é–¥–∞–µ—Ç–µ</em>. –Ø –∑–∞–º–µ—á–∞—é –º–µ–ª—å—á–∞–π—à–∏–µ –¥–µ—Ç–∞–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ —É–ø—É—Å–∫–∞—é—Ç, –∏ —Å–æ–µ–¥–∏–Ω—è—é –∏—Ö –≤ –ª–æ–≥–∏—á–µ—Å–∫—É—é —Ü–µ–ø–æ—á–∫—É.",
            "–î–µ–¥—É–∫—Ü–∏—è - —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞. –Ø –∏—Å–∫–ª—é—á–∞—é –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ, –∏ —Ç–æ, —á—Ç–æ –æ—Å—Ç–∞–µ—Ç—Å—è, –∫–∞–∫–∏–º –±—ã –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–º –æ–Ω–æ –Ω–∏ –∫–∞–∑–∞–ª–æ—Å—å, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–∞–≤–¥–æ–π.",
            "–ú–æ–π –º–µ—Ç–æ–¥ –ø—Ä–æ—Å—Ç: –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ, –∞–Ω–∞–ª–∏–∑, –¥–µ–¥—É–∫—Ü–∏—è. –Ø –∑–∞–º–µ—á–∞—é —Ç–æ, —á—Ç–æ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç, –∏ —Å–æ–µ–¥–∏–Ω—è—é —Ñ–∞–∫—Ç—ã –≤ –µ–¥–∏–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É."
        ]
    
    elif question_type == 'watson':
        responses = [
            "–ê—Ö, –º–æ–π –¥–æ—Ä–æ–≥–æ–π –í–∞—Ç—Å–æ–Ω! –ú–æ–π –≤–µ—Ä–Ω—ã–π –¥—Ä—É–≥ –∏ –ø–æ–º–æ—â–Ω–∏–∫. –•–æ—Ç—è –æ–Ω –∏–Ω–æ–≥–¥–∞ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç –º–æ–∏—Ö –º–µ—Ç–æ–¥–æ–≤, –µ–≥–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –∏ –∑–∞–ø–∏—Å–∏ –Ω–∞—à–∏—Ö –¥–µ–ª –±–µ—Å—Ü–µ–Ω–Ω—ã –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∫—Ä–∏–º–∏–Ω–∞–ª–∏—Å—Ç–∏–∫–∏.",
            "–î–æ–∫—Ç–æ—Ä –í–∞—Ç—Å–æ–Ω - –º–æ–π –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–π –∫–æ–º–ø–∞–Ω—å–æ–Ω. –ï–≥–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∑–Ω–∞–Ω–∏—è –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ –Ω–∞–±–ª—é–¥–µ–Ω–∏—é —á–∞—Å—Ç–æ –¥–æ–ø–æ–ª–Ω—è—é—Ç –º–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥.",
            "–í–∞—Ç—Å–æ–Ω - –Ω–µ –ø—Ä–æ—Å—Ç–æ –º–æ–π –¥—Ä—É–≥, –Ω–æ –∏ –º–æ–π –ª–µ—Ç–æ–ø–∏—Å–µ—Ü. –ë–µ–∑ –µ–≥–æ –∑–∞–ø–∏—Å–µ–π –º–Ω–æ–≥–∏–µ –∏–∑ –º–æ–∏—Ö –¥–µ–ª –±—ã–ª–∏ –±—ã –∑–∞–±—ã—Ç—ã."
        ]
    
    elif question_type == 'location':
        responses = [
            "–î–∞, —è –∂–∏–≤—É –Ω–∞ –ë–µ–π–∫–µ—Ä-—Å—Ç—Ä–∏—Ç, 221–ë, –≤ –õ–æ–Ω–¥–æ–Ω–µ. –ú–æ–π –¥–æ–º - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∂–∏–ª–∏—â–µ, —ç—Ç–æ —Ü–µ–Ω—Ç—Ä –º–æ–∏—Ö —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π. –ó–¥–µ—Å—å —è –∏–≥—Ä–∞—é –Ω–∞ —Å–∫—Ä–∏–ø–∫–µ, –ø—Ä–æ–≤–æ–∂—É —Ö–∏–º–∏—á–µ—Å–∫–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ –ø—Ä–∏–Ω–∏–º–∞—é –∫–ª–∏–µ–Ω—Ç–æ–≤.",
            "–ë–µ–π–∫–µ—Ä-—Å—Ç—Ä–∏—Ç, 221–ë - –º–æ–π –¥–æ–º –∏ –æ—Ñ–∏—Å. –ó–¥–µ—Å—å —è –ø—Ä–∏–Ω–∏–º–∞—é –∫–ª–∏–µ–Ω—Ç–æ–≤, –ø—Ä–æ–≤–æ–∂—É —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ —Ä–∞–∑–º—ã—à–ª—è—é –Ω–∞–¥ —Å–ª–æ–∂–Ω—ã–º–∏ —Å–ª—É—á–∞—è–º–∏.",
            "–ú–æ–π –∞–¥—Ä–µ—Å: –ë–µ–π–∫–µ—Ä-—Å—Ç—Ä–∏—Ç, 221–ë, –õ–æ–Ω–¥–æ–Ω. –≠—Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ —Ä–æ–∂–¥–∞—é—Ç—Å—è —Ä–µ—à–µ–Ω–∏—è —Å–∞–º—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≥–∞–¥–æ–∫."
        ]
    
    elif question_type == 'music':
        responses = [
            "–ú—É–∑—ã–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç –º–Ω–µ –¥—É–º–∞—Ç—å, –º–æ–π –¥–æ—Ä–æ–≥–æ–π –¥—Ä—É–≥. –ö–æ–≥–¥–∞ —è –∏–≥—Ä–∞—é –Ω–∞ —Å–∫—Ä–∏–ø–∫–µ, –º–æ–π —É–º –º–æ–∂–µ—Ç —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ —Å–∞–º—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≥–∞–¥–∫–∞—Ö. –≠—Ç–æ –∫–∞–∫ –º–µ–¥–∏—Ç–∞—Ü–∏—è –¥–ª—è –¥–µ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è.",
            "–°–∫—Ä–∏–ø–∫–∞ - –º–æ–π –≤–µ—Ä–Ω—ã–π —Å–ø—É—Ç–Ω–∏–∫ –≤ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è—Ö. –ú–µ–ª–æ–¥–∏–∏ –ø–æ–º–æ–≥–∞—é—Ç —É–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –º—ã—Å–ª–∏ –∏ –Ω–∞–π—Ç–∏ —Ä–µ—à–µ–Ω–∏–µ –≤ —Å–∞–º—ã—Ö –∑–∞–ø—É—Ç–∞–Ω–Ω—ã—Ö –¥–µ–ª–∞—Ö.",
            "–ú—É–∑—ã–∫–∞ –∏ –¥–µ–¥—É–∫—Ü–∏—è –∏–¥—É—Ç —Ä—É–∫–∞ –æ–± —Ä—É–∫—É. –ú–æ—è —Å–∫—Ä–∏–ø–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç –º–Ω–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –¥–µ—Ç–∞–ª—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ —É–ø—É—Å–∫–∞—é—Ç –¥—Ä—É–≥–∏–µ."
        ]
    
    elif question_type == 'drugs':
        responses = [
            "–•–º, –≤—ã –≥–æ–≤–æ—Ä–∏—Ç–µ –æ –º–æ–∏—Ö... —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö. –î–∞, —è –∏–Ω–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é –∫–æ–∫–∞–∏–Ω –¥–ª—è —Å—Ç–∏–º—É–ª—è—Ü–∏–∏ —É–º–∞, –∫–æ–≥–¥–∞ –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –¥–µ–ª. –ù–æ —ç—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –º–æ–∏ –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.",
            "–ú–æ–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å –∫–æ–∫–∞–∏–Ω–æ–º - —ç—Ç–æ —Å–ø–æ—Å–æ–± –±–æ—Ä—å–±—ã —Å —Å–∫—É–∫–æ–π –º–µ–∂–¥—É –¥–µ–ª–∞–º–∏. –ù–æ –∫–æ–≥–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∑–∞–≥–∞–¥–∫–∞, —è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω –Ω–∞ –Ω–µ–π.",
            "–î–∞, —è –ø—Ä–∏–∑–Ω–∞—é —Å–≤–æ—é –ø—Ä–∏–≤—ã—á–∫—É. –ù–æ –æ–Ω–∞ –Ω–µ –º–µ—à–∞–µ—Ç –º–æ–µ–π —Ä–∞–±–æ—Ç–µ - —Å–∫–æ—Ä–µ–µ, –ø–æ–º–æ–≥–∞–µ—Ç —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –ø–µ—Ä–∏–æ–¥–∞–º–∏ –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è."
        ]
    
    elif question_type == 'elementary':
        responses = [
            "<strong>–≠–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–æ, –º–æ–π –¥–æ—Ä–æ–≥–æ–π –í–∞—Ç—Å–æ–Ω!</strong> –ö–æ–≥–¥–∞ –≤—ã –∏—Å–∫–ª—é—á–∏—Ç–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ, —Ç–æ, —á—Ç–æ –æ—Å—Ç–∞–µ—Ç—Å—è, –∏ –µ—Å—Ç—å –ø—Ä–∞–≤–¥–∞.",
            "–≠–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–æ! –ü—Ä–æ—Å—Ç–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∏ –ª–æ–≥–∏–∫–∞ - –≤–æ—Ç –∫–ª—é—á –∫ —Ä–µ—à–µ–Ω–∏—é –ª—é–±–æ–π –∑–∞–≥–∞–¥–∫–∏.",
            "–≠–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–æ, –í–∞—Ç—Å–æ–Ω! –î–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–¥–≤–æ–¥–∏—Ç."
        ]
    
    elif question_type == 'weather':
        responses = [
            "–ü–æ–≥–æ–¥–∞ –≤ –õ–æ–Ω–¥–æ–Ω–µ —á–∞—Å—Ç–æ –±—ã–≤–∞–µ—Ç —Ç—É–º–∞–Ω–Ω–æ–π, —á—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –¥–ª—è –º–æ–∏—Ö —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π. –¢—É–º–∞–Ω —Å–∫—Ä—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏, –Ω–æ –Ω–µ –æ—Ç –º–æ–µ–≥–æ –¥–µ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞.",
            "–õ–æ–Ω–¥–æ–Ω—Å–∫–∞—è –ø–æ–≥–æ–¥–∞ - —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–≥–∞–¥–∫–∞! –ù–æ –æ–Ω–∞ –Ω–µ –º–µ—à–∞–µ—Ç –º–æ–∏–º —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è–º. –ö–∞–∂–¥–∞—è –¥–µ—Ç–∞–ª—å –≤–∞–∂–Ω–∞, –¥–∞–∂–µ –∫–∞–ø–ª–∏ –¥–æ–∂–¥—è –Ω–∞ –æ–∫–Ω–µ.",
            "–ü–æ–≥–æ–¥–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ —É–ª–∏–∫–∏, –º–æ–π –¥–æ—Ä–æ–≥–æ–π –¥—Ä—É–≥. –î–æ–∂–¥—å –º–æ–∂–µ—Ç —Å–º—ã—Ç—å —Å–ª–µ–¥—ã, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç —Å–∫—Ä—ã—Ç—å –ª–æ–≥–∏–∫—É –¥–µ–¥—É–∫—Ü–∏–∏."
        ]
    
    elif question_type == 'time':
        responses = [
            "–í—Ä–µ–º—è - —ç—Ç–æ –≤–∞–∂–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –ª—é–±–æ–º —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏. –•—Ä–æ–Ω–æ–ª–æ–≥–∏—è —Å–æ–±—ã—Ç–∏–π —á–∞—Å—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–æ–º –∫ —Ä–∞–∑–≥–∞–¥–∫–µ.",
            "–í—Ä–µ–º—è –Ω–µ –∂–¥–µ—Ç, –º–æ–π –¥–æ—Ä–æ–≥–æ–π –¥—Ä—É–≥. –ö–∞–∂–¥–∞—è –º–∏–Ω—É—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ—à–∞—é—â–µ–π –≤ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏.",
            "–í—Ä–µ–º—è - —ç—Ç–æ —Ñ–∞–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π —è –≤—Å–µ–≥–¥–∞ —É—á–∏—Ç—ã–≤–∞—é –≤ —Å–≤–æ–∏—Ö –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã—Ö –≤—ã–≤–æ–¥–∞—Ö."
        ]
    
    elif question_type == 'food':
        responses = [
            "–ß–∞–π - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—Ç–æ–∫, —ç—Ç–æ —Ä–∏—Ç—É–∞–ª —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π. –ß–∞—à–∫–∞ –≥–æ—Ä—è—á–µ–≥–æ —á–∞—è –ø–æ–º–æ–≥–∞–µ—Ç –º–Ω–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –¥–µ—Ç–∞–ª—è—Ö.",
            "–ï–¥–∞ - —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å, –Ω–æ –º–æ–π —É–º —á–∞—Å—Ç–æ —Å–ª–∏—à–∫–æ–º –∑–∞–Ω—è—Ç —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º, —á—Ç–æ–±—ã –¥—É–º–∞—Ç—å –æ —Ç–∞–∫–∏—Ö –º–µ–ª–æ—á–∞—Ö.",
            "–ß–∞–π –∏ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è –∏–¥—É—Ç —Ä—É–∫–∞ –æ–± —Ä—É–∫—É –≤ –º–æ–µ–º –∫–∞–±–∏–Ω–µ—Ç–µ –Ω–∞ –ë–µ–π–∫–µ—Ä-—Å—Ç—Ä–∏—Ç."
        ]
    
    elif question_type == 'clothes':
        responses = [
            "–û–¥–µ–∂–¥–∞ –º–æ–∂–µ—Ç –º–Ω–æ–≥–æ–µ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ —á–µ–ª–æ–≤–µ–∫–µ, –º–æ–π –¥–æ—Ä–æ–≥–æ–π –¥—Ä—É–≥. –ö–∞—á–µ—Å—Ç–≤–æ —Ç–∫–∞–Ω–∏, —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Å—Ç–∏–ª—å - –≤—Å–µ —ç—Ç–æ –≤–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –¥–ª—è –¥–µ–¥—É–∫—Ü–∏–∏.",
            "–ú–æ–π –∫–æ—Å—Ç—é–º –∏ —à–ª—è–ø–∞ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ–¥–µ–∂–¥–∞, —ç—Ç–æ —á–∞—Å—Ç—å –º–æ–µ–≥–æ –æ–±—Ä–∞–∑–∞ –¥–µ—Ç–µ–∫—Ç–∏–≤–∞-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞.",
            "–í –æ–¥–µ–∂–¥–µ —á–µ–ª–æ–≤–µ–∫–∞ —Å–∫—Ä—ã—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —É–ª–∏–∫. –Ø –≤—Å–µ–≥–¥–∞ –æ–±—Ä–∞—â–∞—é –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–∞–∫–∏–µ –¥–µ—Ç–∞–ª–∏."
        ]
    
    elif question_type == 'transport':
        responses = [
            "–°—Ä–µ–¥—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏—è –æ—Å—Ç–∞–≤–ª—è—é—Ç —Å–ª–µ–¥—ã, –º–æ–π –¥–æ—Ä–æ–≥–æ–π –¥—Ä—É–≥. –ö–æ–ª–µ—Å–∞ –∫–∞—Ä–µ—Ç—ã, –∫–æ–ø—ã—Ç–∞ –ª–æ—à–∞–¥–µ–π - –≤—Å–µ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–Ω–æ–π —É–ª–∏–∫–æ–π.",
            "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç - —ç—Ç–æ –≤–∞–∂–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏. –û–Ω –º–æ–∂–µ—Ç —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ –º–∞—Ä—à—Ä—É—Ç–µ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–∞.",
            "–ö–∞–∂–¥—ã–π –≤–∏–¥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–≤–æ–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–ª–µ–¥—ã. –≠—Ç–æ –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å –¥–µ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞."
        ]
    
    elif context and len(context) > 10:
        # –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –≤–µ–±-—Å–∫—Ä–∞–ø–∏–Ω–≥–∞
        responses = [
            f"–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! –û—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, —è –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ: <strong>–∫–æ–Ω—Ç–µ–∫—Å—Ç –±—ã–ª —É—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω</strong>. –¢–µ–ø–µ—Ä—å —è –º–æ–≥—É –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—è —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ. –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?",
            f"–û—Ç–ª–∏—á–Ω–æ! –Ø –∏–∑—É—á–∏–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. <strong>–î–∞–Ω–Ω—ã–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã</strong> –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã!",
            f"–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ –º–æ–∏–º –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–º –º–µ—Ç–æ–¥–æ–º. <strong>–ö–æ–Ω—Ç–µ–∫—Å—Ç –≥–æ—Ç–æ–≤</strong> –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞."
        ]
    
    else:
        # –û–±—â–∏–π –æ—Ç–≤–µ—Ç —Å –±–æ–ª—å—à–∏–º —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º
        responses = [
            "–•–º, –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ, –º–æ–π –¥–æ—Ä–æ–≥–æ–π –¥—Ä—É–≥. –ü–æ–∑–≤–æ–ª—å—Ç–µ –º–Ω–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–≤–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∫ —ç—Ç–æ–º—É –≤–æ–ø—Ä–æ—Å—É.",
            "–≠–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–æ! –•–æ—Ç—è, –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–µ —Å–æ–≤—Å–µ–º. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º —ç—Ç–æ –ø–æ –ø–æ—Ä—è–¥–∫—É.",
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∑–∞–≥–∞–¥–∫–∞! –ú–æ–π —É–º —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥ —Ä–µ—à–µ–Ω–∏–µ–º.",
            "–ü–æ–∑–≤–æ–ª—å—Ç–µ –º–Ω–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É —Å–∏—Ç—É–∞—Ü–∏—é —Å –ø–æ–º–æ—â—å—é –ª–æ–≥–∏–∫–∏ –∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è.",
            "–•–º, —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –ú–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –≤ –¥–µ–π—Å—Ç–≤–∏–∏!",
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! –ö–∞–∂–¥—ã–π —Ñ–∞–∫—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–ª—é—á–æ–º –∫ —Ä–∞–∑–≥–∞–¥–∫–µ. –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –±–æ–ª—å—à–µ.",
            "–ú–æ–π –¥–æ—Ä–æ–≥–æ–π –í–∞—Ç—Å–æ–Ω, —ç—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–ª—É—á–∞–π –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –¥–µ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞!",
            "–ü–æ–∑–≤–æ–ª—å—Ç–µ –º–Ω–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–≤–æ–π –º–µ—Ç–æ–¥: <em>–∫–æ–≥–¥–∞ —Ç—ã –∏—Å–∫–ª—é—á–∏—à—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ, —Ç–æ, —á—Ç–æ –æ—Å—Ç–∞–µ—Ç—Å—è, –∏ –µ—Å—Ç—å –ø—Ä–∞–≤–¥–∞</em>.",
            "–•–º, –∏–Ω—Ç—Ä–∏–≥—É—é—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞! –ú–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∂–∞–∂–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.",
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ! –ü–æ–∑–≤–æ–ª—å—Ç–µ –º–Ω–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –∫ —ç—Ç–æ–º—É –≤–æ–ø—Ä–æ—Å—É.",
            "–•–º, —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –º–æ–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è. –î–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –≤ –¥–µ–π—Å—Ç–≤–∏–∏!",
            "–û—Ç–ª–∏—á–Ω–æ! –ù–æ–≤—ã–π –≤—ã–∑–æ–≤ –¥–ª—è –º–æ–µ–≥–æ –º–µ—Ç–æ–¥–∞. –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ.",
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∑–∞–≥–∞–¥–∫–∞! –ú–æ–π —É–º —É–∂–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è.",
            "–•–º, —ç—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–ª—É—á–∞–π –¥–ª—è –¥–µ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.",
            "–ü–æ–∑–≤–æ–ª—å—Ç–µ –º–Ω–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–≤–æ–π –º–µ—Ç–æ–¥ –∫ —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º–µ.",
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! –ú–æ–π –¥–µ–¥—É–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.",
            "–•–º, —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –º–æ–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è. –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ.",
            "–û—Ç–ª–∏—á–Ω–æ! –ù–æ–≤—ã–π —Å–ª—É—á–∞–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.",
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞! –ú–æ–π –º–µ—Ç–æ–¥ –≤ –¥–µ–π—Å—Ç–≤–∏–∏.",
            "–•–º, —ç—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–ª—É—á–∞–π –¥–ª—è –¥–µ–¥—É–∫—Ü–∏–∏."
        ]
    
    import random
    return random.choice(responses)

def scrape_website(url):
    """–°–∫—Ä–∞–ø–∏–Ω–≥ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã"""
    try:
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
        }
        
        response = requests.get(url, headers=headers, timeout=10)
        response.raise_for_status()
        
        soup = BeautifulSoup(response.content, 'html.parser')
        
        # –£–¥–∞–ª—è–µ–º —Å–∫—Ä–∏–ø—Ç—ã –∏ —Å—Ç–∏–ª–∏
        for script in soup(["script", "style"]):
            script.decompose()
        
        # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç
        text = soup.get_text()
        
        # –û—á–∏—â–∞–µ–º —Ç–µ–∫—Å—Ç
        lines = (line.strip() for line in text.splitlines())
        chunks = (phrase.strip() for line in lines for phrase in line.split("  "))
        text = ' '.join(chunk for chunk in chunks if chunk)
        
        return {
            'url': url,
            'title': soup.title.string if soup.title else url,
            'content': text[:2000],  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä
            'timestamp': datetime.now().isoformat()
        }
        
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ —Å–∫—Ä–∞–ø–∏–Ω–≥–∞: {e}")
        return None

def find_relevant_context(question, top_k=3):
    """–ü–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è RAG (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)"""
    if not scraped_content:
        return ""
    
    try:
        # –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
        question_lower = question.lower()
        relevant_chunks = []
        
        for content in scraped_content:
            content_lower = content['content'].lower()
            
            # –ò—â–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å–ª–æ–≤
            question_words = set(question_lower.split())
            content_words = set(content_lower.split())
            
            # –í—ã—á–∏—Å–ª—è–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ
            common_words = question_words.intersection(content_words)
            relevance_score = len(common_words) / len(question_words) if question_words else 0
            
            if relevance_score > 0.1:  # –ü–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
                relevant_chunks.append((relevance_score, content['content'][:500]))
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
        relevant_chunks.sort(reverse=True)
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ø –∫–æ–Ω—Ç–µ–∫—Å—Ç
        relevant_context = "\n".join([text for _, text in relevant_chunks[:top_k]])
        return relevant_context
        
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: {e}")
        return ""

@app.route('/')
def index():
    return render_template('huggingchat.html')

@app.route('/chat', methods=['POST'])
def chat():
    try:
        data = request.get_json()
        message = data.get('message', '').strip()
        
        if not message:
            return jsonify({'error': '–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º'})
        
        # –ü–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
        context = find_relevant_context(message)
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
        response = generate_response(message, context)
        
        return jsonify({
            'response': response,
            'timestamp': datetime.now().strftime('%H:%M:%S')
        })
        
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ —á–∞—Ç–∞: {e}")
        return jsonify({'error': '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞'})

@app.route('/scrape', methods=['POST'])
def scrape():
    try:
        data = request.get_json()
        url = data.get('url', '').strip()
        
        if not url:
            return jsonify({'error': 'URL –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º'})
        
        # –°–∫—Ä–∞–ø–∏–Ω–≥ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã
        scraped_data = scrape_website(url)
        
        if scraped_data:
            # –î–æ–±–∞–≤–ª—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫
            scraped_content.append(scraped_data)
            
            return jsonify({
                'success': True,
                'message': f'–°–∞–π—Ç {url} —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω! –î–æ–±–∞–≤–ª–µ–Ω–æ {len(scraped_data["content"])} —Å–∏–º–≤–æ–ª–æ–≤ —Ç–µ–∫—Å—Ç–∞.',
                'title': scraped_data['title'],
                'timestamp': scraped_data['timestamp']
            })
        else:
            return jsonify({'error': '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–π URL'})
        
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ —Å–∫—Ä–∞–ø–∏–Ω–≥–∞: {e}")
        return jsonify({'error': '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ URL'})

@app.route('/status')
def status():
    """–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã"""
    return jsonify({
        'status': 'running',
        'model': 'HuggingChat Integration + Fallback',
        'scraped_sites': len(scraped_content),
        'huggingchat_url': HUGGINGCHAT_URL
    })

if __name__ == '__main__':
    print("ü§ñ –ó–∞–ø—É—Å–∫ AI-–±–æ—Ç–∞ –®–µ—Ä–ª–æ–∫–∞ –•–æ–ª–º—Å–∞ —Å HuggingChat –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π...")
    print("üöÄ –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞...")
    app.run(host='0.0.0.0', port=5000, debug=True) 